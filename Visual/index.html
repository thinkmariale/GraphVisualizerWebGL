<!DOCTYPE html>
<html>
<head>
    <title>My Graphs with Three.js</title>    
    <script src="build/three.min.js"></script>
	<script src="myApp.js"></script>
	<script src="Graph.js"></script>
	<script src="Layout.js"></script>
	<script src="Label.js"></script>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js"></script>
	
    <script>
		// In your JavaScript
		var uid, accessToken, group;
		var auth_response_change_callback = function(response) {
			console.log("auth_response_change_callback");
		 	console.log(response);	
		}
		function updateStatusCallback()
		{
			FB.getLoginStatus(function(response) {
				if (response.status === 'connected') {
					 console.log("connected");
					//var session = FB.getSession();
					//fbtoken = session.access_token;
					//fbuserid = session.uid;
					// the user is logged in and has authenticated your
					// app, and response.authResponse supplies
					// the user's ID, a valid access token, a signed
					// request, and the time the access token 
					// and signed request each expire
					uid = response.authResponse.userID;
					accessToken = response.authResponse.accessToken;
					group = "/216740458468148/feed?limit=50?access_token="+accessToken;
					console.log("group " + group);
					
					/* make the API call */
					FB.api(
						group ,
						function (response) {
							if (response && !response.error) {
								/* handle the result */
								console.log("group");
								console.log(response);
								loadNodes(response);
								
							}
							else  console.log( response );
						}
					);
				} 
				else if (response.status === 'not_authorized') {
				   alert("not authorized");
					// the user is logged in to Facebook, 
					// but has not authenticated your app
				} else {
					// the user isn't logged in to Facebook.
				}
			});
		}
		/*window.onload = function() {
		   var layout;
		   initScene();
		};*/
		$(document).ready(function() {
			$.ajaxSetup({ cache: true });
			$.getScript('//connect.facebook.net/en_UK/all.js', function(){
				
				FB.init({
					appId: '498450693628292',
				});
				FB.login(function(response) {
					
				   if (response.authResponse) {
					   console.log('Welcome!  Fetching your information.... ');
					 	FB.api('/me', function(response) {
					   		console.log('Good to see you, ' + response.name + '.');
					 	});
				   } else {
					 	console.log('User cancelled login or did not fully authorize.');
				   }
				 }, {perms:'user_groups'} );
				
				FB.Event.subscribe('auth.authResponseChange', auth_response_change_callback);
				//$('#loginbutton,#feedbutton').removeAttr('disabled');
				FB.getLoginStatus(updateStatusCallback);

			});
		});
		
		
	
	</script>
	
	<script>
		function startGraph()
		{
			if(document.getElementById("startG").textContent == "Graph Loaded")
				return;
			document.getElementById("startG").textContent = "Graph Loaded"	
		 	var layout;
			initScene();	
		}
    </script>
	
</head>
	
	
<body>
<fb:login-button autologoutlink="true"></fb:login-button>	
	<button id ="startG" onclick="startGraph()"> Strat Graph </button>
</body>
</html>